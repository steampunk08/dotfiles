#!/usr/bin/bash

# To-do manager... mostly used for my prompt

[[ -z $TODO_PATH ]] && TODO_PATH=~/.todo
[[ -f $TODO_PATH ]] || touch $TODO_PATH

function show_usage() { 
   echo "script to manage todo's in \$TODO_PATH"
   echo
   echo "Usage: todo [option] [message]"
   echo
   echo "Options"
   echo "    -c, clear the todo file before writing [message]"
   echo "    -e, use \$EDITOR to edit todo file"
   echo "    -h, show this message"
   echo "    -l, list all todos"
   echo 
   echo "Todo script written by Sphe M"
   exit 1
}

list_todos() {
   todos=$(cat $TODO_PATH 2>/dev/null)
   [[ -z $todos ]] && todos="you don't have any todos"

   echo -n "$todos" | awk '{ print "* "$0 }'
}

while getopts ":celh" option; do
   case $option in
      c ) echo -n > $TODO_PATH && exit ;;
      e ) $EDITOR $TODO_PATH ;;
      l ) list_todos && exit ;;
      h ) show_usage ;;
      * ) show_usage ;;
   esac
done

if [[ $option == "?" ]] && [[ -n $1 ]]; then
   echo $@ >> $TODO_PATH 
fi
